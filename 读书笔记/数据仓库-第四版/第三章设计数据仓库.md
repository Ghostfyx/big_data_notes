# 第三章 设计数据仓库

建造数据仓库主要包括两个部分的工作——与操作型系统接口的设计和数据仓库本身的设计。因为“设计”一次暗含了可以预先对组成单元进行规划的意思，所以用在这里不完全正确，数据仓库的需求只有在已装载了部分数据并开始使用时才能弄清楚。数据仓库是启发方式下键槽的，在这个过程中一个阶段的开发完全依赖于上一阶段获得的结果。首先，载入一部分数据供DSS分析员使用和查看，最终根据用户的反馈，修改数据和/或添加其他数据，然后建立数据仓库的另一部分，如此继续。这种反馈过程穿于数据仓库的整个开发生命周期之中。

因此，数据仓库的设计不能采用与传统的需求驱动的系统相同的方法进行。

## 3.1 从操作型数据开始

设计时首先要考虑的问题是如何将数据放置在数据仓库中，数据从操作型环境到数据仓库的放置过程中有许多需要考虑的东西。

起初，面向事务处理的操作型数据被封锁在现有历史系统中。仅仅是将数据从历史环境中取出并放到数据仓库中几乎挖掘不出数据仓库的任何潜力。

图3-1简单地展示了数据从现有历史系统环境转移到数据仓库的过程。这里，我们可以看到，有多个应用向数据仓库提供数据。

![](img/3-1.jpg)

​							**图3-1 将数据从操作型环境移入数据仓库环境不是简单的抽取**

图3-1显得过于简单了，这里有很多原因，最重要的一个原因是，这一过程没有考虑到操作型环境中的数据是未经集成的。图3-2描述了一个典型的现有系统中缺乏集成的情况，将未经集成的数据载入到数据仓库是一个极端严重的错误。

![](img/3-2.jpg)

​												**图3-2 不同应用的数据集成性很差**

在建立现有应用时，根本没有考虑过以后可能存在的集成问题，每一个应用都有其独有的特殊的需求。因此，出现相同的数据以不同的名字出现在各个地方，一些数据在不同的地方以相同的方式标注，一些数据用相同的名字存在相同的地方却使用了不同的度量单位等等。从多处抽取数据并将数据集成到一个统一的视图中是一个非常复杂的问题。

如图3-3所示，为了从操作型环境中适当地抽取数据，必须对无数细节编程进行一致性处理。

![](img/3-3.jpg)

​			**图3-3 为了将现有系统环境中的数据正确转移到数据仓库环境中，必须进行集成**

数据缺乏集成的一个简单例子就是数据编码不一致，如图对性别的不同编码，在一个应用中，性别编码为"m/f"；另一个为“0/1”。在数据仓库中，只要性别的编码方法一致，因此：

- **在数据进入数据仓库时，必须先对各个应用的不同值进行正确地译码，然后再重新编码为合适的值**
- **必须将管道的度量单位转换为唯一并且一致的全局度量标准**
- **对于同一字段在不同应用中有不同的名称，必须建立不同源字段到数据仓库字段的映射**
- **原有数据在不同DBMS下可能以多种不同格式存储，所有数据都必须转换到另一种技术下存储**

另一个主要问题是访问现有系统数据的效率，扫描现有系统的程序如何知道一个文件已经被扫描过呢？现有系统环境中有大量的数据，每次进行数据仓库装载时都试图对所有数据扫描一次，既会产生极大的浪费，同事也是不现实的。

------

从操作型数据库导入数据到数据仓库有三大主要问题：

- 操作型系统表数据口径和标准不同需要统一转换为数据仓库的标准口径
- 操作型系统数据存储介质不同，数据同步时，数据仓库需要兼容多种存储介质读取数据
- 访问操作型数据的读取效率（我知道的解决方案：拉链表）

------

