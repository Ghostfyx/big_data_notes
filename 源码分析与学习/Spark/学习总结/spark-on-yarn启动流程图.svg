<svg id="SvgjsSvg1370" width="1650" height="529" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1371"><marker id="SvgjsMarker1394" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1395" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1414" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1415" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1430" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1431" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1440" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1441" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1460" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1461" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1476" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1477" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1480" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1481" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1484" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1485" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1500" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1501" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1508" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1509" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1372" transform="translate(723,38)"><path id="SvgjsPath1373" d="M 0 0L 902 0L 902 466L 0 466Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffcccc"></path><g id="SvgjsG1374"><text id="SvgjsText1375" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="0" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="223.05" transform="rotate(0)"></text></g></g><g id="SvgjsG1376" transform="translate(540,25)"><path id="SvgjsPath1377" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1378"><text id="SvgjsText1379" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="69" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.05" transform="rotate(0)"><tspan id="SvgjsTspan1380" dy="16" x="50"><tspan id="SvgjsTspan1381" style="text-decoration:;">spark-</tspan></tspan><tspan id="SvgjsTspan1382" dy="16" x="50"><tspan id="SvgjsTspan1383" style="text-decoration:;">submit脚本</tspan></tspan></text></g></g><g id="SvgjsG1384" transform="translate(530,148)"><path id="SvgjsPath1385" d="M 0 40L 60 0L 120 40L 60 80Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1386"><text id="SvgjsText1387" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="98" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="22.45" transform="rotate(0)"><tspan id="SvgjsTspan1388" dy="16" x="60"><tspan id="SvgjsTspan1389" style="text-decoration:;">--master</tspan></tspan><tspan id="SvgjsTspan1390" dy="16" x="60"><tspan id="SvgjsTspan1391" style="text-decoration:;">-- deploy mode</tspan></tspan></text></g></g><g id="SvgjsG1392"><path id="SvgjsPath1393" d="M590 95L590 121.5L590 121.5L590 148" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1394)"></path></g><g id="SvgjsG1396" transform="translate(746,247)"><path id="SvgjsPath1397" d="M 0 4Q 0 0 4 0L 492 0Q 496 0 496 4L 496 98Q 496 102 492 102L 4 102Q 0 102 0 98Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1398"><text id="SvgjsText1399" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="394" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.05" transform="rotate(0)"><tspan id="SvgjsTspan1400" dy="16" x="248"><tspan id="SvgjsTspan1401" style="text-decoration:;">org.apache.spark.deploy.SparkSubmit  main函数</tspan></tspan><tspan id="SvgjsTspan1402" dy="16" x="248"><tspan id="SvgjsTspan1403" style="text-decoration:;">org.apache.spark.deploy.yarn.YarnClusterApplication main函数</tspan></tspan><tspan id="SvgjsTspan1404" dy="16" x="248"><tspan id="SvgjsTspan1405" style="text-decoration:;">org.apache.spark.deploy.yarn.Client run函数</tspan></tspan><tspan id="SvgjsTspan1406" dy="16" x="248"><tspan id="SvgjsTspan1407" style="text-decoration:;">org.apache.hadoop.yarn.client.api.YarnClient createYarnClient</tspan></tspan><tspan id="SvgjsTspan1408" dy="16" x="248"><tspan id="SvgjsTspan1409" style="text-decoration:;">org.apache.hadoop.yarn.client.api.YarnClient createApplication</tspan></tspan><tspan id="SvgjsTspan1410" dy="16" x="248"><tspan id="SvgjsTspan1411" style="text-decoration:;">org.apache.hadoop.yarn.client.api.YarnClient submitApplication</tspan></tspan></text></g></g><g id="SvgjsG1412"><path id="SvgjsPath1413" d="M650 188L994 188L994 247" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1414)"></path><rect id="SvgjsRect1416" width="83" height="16" x="810" y="180" fill="#ffffff"></rect><text id="SvgjsText1417" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="83" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="178.05" transform="rotate(0)"><tspan id="SvgjsTspan1418" dy="16" x="851.5"><tspan id="SvgjsTspan1419" style="text-decoration:;">YARN-cluster</tspan></tspan></text></g><g id="SvgjsG1420" transform="translate(1309,155)"><path id="SvgjsPath1421" d="M 0 4Q 0 0 4 0L 244 0Q 248 0 248 4L 248 62Q 248 66 244 66L 4 66Q 0 66 0 62Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1422"><text id="SvgjsText1423" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="225" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="15.05" transform="rotate(0)"><tspan id="SvgjsTspan1424" dy="16" x="124"><tspan id="SvgjsTspan1425" style="text-decoration:;">向RM提交申请，启动一个Container来</tspan></tspan><tspan id="SvgjsTspan1426" dy="16" x="124"><tspan id="SvgjsTspan1427" style="text-decoration:;">运行AM，这里AM指的是Driver</tspan></tspan></text></g></g><g id="SvgjsG1428"><path id="SvgjsPath1429" d="M1242 298L1275.5 298L1275.5 188L1309 188" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1430)"></path></g><g id="SvgjsG1432" transform="translate(1309,272)"><path id="SvgjsPath1433" d="M 0 4Q 0 0 4 0L 244 0Q 248 0 248 4L 248 62Q 248 66 244 66L 4 66Q 0 66 0 62Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1434"><text id="SvgjsText1435" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="209" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="23.05" transform="rotate(0)"><tspan id="SvgjsTspan1436" dy="16" x="124"><tspan id="SvgjsTspan1437" style="text-decoration:;">AM中负责调用应用程序的main方法</tspan></tspan></text></g></g><g id="SvgjsG1438"><path id="SvgjsPath1439" d="M1433 221L1433 246.5L1433 246.5L1433 272" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1440)"></path></g><g id="SvgjsG1442" transform="translate(1309,392.5)"><path id="SvgjsPath1443" d="M 0 4Q 0 0 4 0L 244 0Q 248 0 248 4L 248 62Q 248 66 244 66L 4 66Q 0 66 0 62Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1444"><text id="SvgjsText1445" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="223" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.05" transform="rotate(0)"><tspan id="SvgjsTspan1446" dy="16" x="124"><tspan id="SvgjsTspan1447" style="text-decoration:;">AM负责SparkContext的实例化工作，</tspan></tspan><tspan id="SvgjsTspan1448" dy="16" x="124"><tspan id="SvgjsTspan1449" style="text-decoration:;">因此此模式下driver运行在</tspan></tspan><tspan id="SvgjsTspan1450" dy="16" x="124"><tspan id="SvgjsTspan1451" style="text-decoration:;">ApplicationMaster进程中</tspan></tspan></text></g></g><g id="SvgjsG1452" transform="translate(540,270)"><path id="SvgjsPath1453" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1454"><text id="SvgjsText1455" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.05" transform="rotate(0)"><tspan id="SvgjsTspan1456" dy="16" x="50"><tspan id="SvgjsTspan1457" style="text-decoration:;">其他</tspan></tspan></text></g></g><g id="SvgjsG1458"><path id="SvgjsPath1459" d="M590 228L590 249L590 249L590 270" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1460)"></path><rect id="SvgjsRect1462" width="193" height="16" x="493.5" y="241" fill="#ffffff"></rect><text id="SvgjsText1463" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="193" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="239.05" transform="rotate(0)"><tspan id="SvgjsTspan1464" dy="16" x="590"><tspan id="SvgjsTspan1465" style="text-decoration:;">其他模式启动：standaline、mes</tspan></tspan></text></g><g id="SvgjsG1466" transform="translate(511.5,396)"><path id="SvgjsPath1467" d="M 0 4Q 0 0 4 0L 153 0Q 157 0 157 4L 157 55Q 157 59 153 59L 4 59Q 0 59 0 55Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1468"><text id="SvgjsText1469" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="136" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1470" dy="16" x="78.5"><tspan id="SvgjsTspan1471" style="text-decoration:;">在应用程序main方法中</tspan></tspan><tspan id="SvgjsTspan1472" dy="16" x="78.5"><tspan id="SvgjsTspan1473" style="text-decoration:;">创建SparkContext实例</tspan></tspan></text></g></g><g id="SvgjsG1474"><path id="SvgjsPath1475" d="M590 340L590 368L590 368L590 396" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1476)"></path></g><g id="SvgjsG1478"><path id="SvgjsPath1479" d="M1309 425.5L988.75 425.5L988.75 425.5L668.5 425.5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1480)"></path></g><g id="SvgjsG1482"><path id="SvgjsPath1483" d="M1433 338L1433 365.25L1433 365.25L1433 392.5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1484)"></path></g><g id="SvgjsG1486" transform="translate(25,257)"><path id="SvgjsPath1487" d="M 0 4Q 0 0 4 0L 362 0Q 366 0 366 4L 366 83Q 366 87 362 87L 4 87Q 0 87 0 83Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1488"><text id="SvgjsText1489" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="341" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.55" transform="rotate(0)"><tspan id="SvgjsTspan1490" dy="16" x="183"><tspan id="SvgjsTspan1491" style="text-decoration:;">org.apache.spark.deploy.SparkSubmit  main函数</tspan></tspan><tspan id="SvgjsTspan1492" dy="16" x="183"><tspan id="SvgjsTspan1493" style="text-decoration:;">org.apache.spark.deploy.JavaMainApplication start函数</tspan></tspan><tspan id="SvgjsTspan1494" dy="16" x="183"><tspan id="SvgjsTspan1495" style="text-decoration:;">通过反射启动spark-submit --master类的main方法</tspan></tspan><tspan id="SvgjsTspan1496" dy="16" x="183"><tspan id="SvgjsTspan1497" style="text-decoration:;">    mainMethod.invoke(null, args)</tspan></tspan></text></g></g><g id="SvgjsG1498"><path id="SvgjsPath1499" d="M530 188L208 188L208 257" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1500)"></path><rect id="SvgjsRect1502" width="76" height="16" x="296.5" y="180" fill="#ffffff"></rect><text id="SvgjsText1503" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="178.05" transform="rotate(0)"><tspan id="SvgjsTspan1504" dy="16" x="334.5"><tspan id="SvgjsTspan1505" style="text-decoration:;">YARN Client</tspan></tspan></text></g><g id="SvgjsG1506"><path id="SvgjsPath1507" d="M208 344L208 425.5L511.5 425.5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1508)"></path></g><g id="SvgjsG1510" transform="translate(734,59)"><path id="SvgjsPath1511" d="M 0 0L 164 0L 164 58L 0 58Z" stroke="none" fill="none"></path><g id="SvgjsG1512"><text id="SvgjsText1513" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="140" fill="#323232" font-weight="700" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="700" font-style="" opacity="1" y="19.05" transform="rotate(0)"><tspan id="SvgjsTspan1514" dy="16" x="82"><tspan id="SvgjsTspan1515" style="text-decoration:;">YARN Cluster第一阶段</tspan></tspan></text></g></g></svg>